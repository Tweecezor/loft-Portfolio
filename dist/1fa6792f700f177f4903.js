(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{404:function(t,e,a){"use strict";a.d(e,"a",function(){return i});var r=a(98),i=function(t){var e=r.a.defaults.baseURL;return"".concat(e,"/").concat(t)}},409:function(t,e,a){},416:function(t,e,a){"use strict";var r=a(409);a.n(r).a},421:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"reviews__content content"},[t._m(0),a("div",{staticClass:"reviews__form"},[a("input",{staticClass:"reviews__user-file",attrs:{type:"file",id:"reviews-avatar",accept:"image/*"},on:{change:t.loadPhoto}}),a("label",{staticClass:"reviews__user",attrs:{for:"reviews-avatar"}},[a("div",{staticClass:"reviews__user-avatar",class:{imaged:t.hasImage,validErrorImg:t.validation.hasError("reviewData.photo")},style:{"background-image":"url("+this.photoURl+")"}}),a("div",{staticClass:"reviews__user-add"},[a("h3",{staticClass:"reviews__user-text"},[t._v(t._s(t.textTitle))])])]),a("div",{staticClass:"reviews__info"},[a("div",{staticClass:"reviews__label-wrap reviews__label-wrap--name"},[a("label",{staticClass:"reviews__label label",attrs:{for:"name"}},[t._v("Имя автора")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.reviewData.author,expression:"reviewData.author"}],staticClass:"input reviews__input",class:{validError:t.validation.hasError("reviewData.author")},attrs:{type:"text",name:"name",id:"name"},domProps:{value:t.reviewData.author},on:{input:function(e){e.target.composing||t.$set(t.reviewData,"author",e.target.value)}}}),t.validation.firstError("reviewData.author")?a("div",{staticClass:"error-input"},[t._v(t._s(t.validation.firstError("reviewData.author")))]):t._e()]),a("div",{staticClass:"reviews__label-wrap reviews__label-wrap--status"},[a("label",{staticClass:"reviews__label label",attrs:{for:"status"}},[t._v("Титул автора")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.reviewData.occ,expression:"reviewData.occ"}],staticClass:"input reviews__input",class:{validError:t.validation.hasError("reviewData.occ")},attrs:{type:"text",name:"status",id:"status"},domProps:{value:t.reviewData.occ},on:{input:function(e){e.target.composing||t.$set(t.reviewData,"occ",e.target.value)}}}),t.validation.firstError("reviewData.occ")?a("div",{staticClass:"error-input"},[t._v(t._s(t.validation.firstError("reviewData.occ")))]):t._e()]),a("div",{staticClass:"reviews__label-wrap reviews__label-wrap--review"},[a("label",{staticClass:"reviews__label label",attrs:{for:"review"}},[t._v("Отзыв")]),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.reviewData.text,expression:"reviewData.text"}],staticClass:"input reviews__input reviews__input--desc",class:{validErrorTextarea:t.validation.hasError("reviewData.text")},attrs:{name:"review",id:"review"},domProps:{value:t.reviewData.text},on:{input:function(e){e.target.composing||t.$set(t.reviewData,"text",e.target.value)}}}),t.validation.firstError("reviewData.text")?a("div",{staticClass:"error-input"},[t._v(t._s(t.validation.firstError("reviewData.text")))]):t._e()]),a("div",{staticClass:"reviews__buttons"},[a("button",{staticClass:"reviews__reset",attrs:{type:"reset",name:"cancel",value:"Отменить"},on:{click:t.toogleAddingForm}},[t._v("Отменить")]),"add"==t.mode?a("button",{staticClass:"btn reviews__submit",attrs:{type:"submit",name:"submit",value:"Сохранить"},on:{click:t.addNewReview}},[t._v("Сохранить")]):t._e(),"edit"==t.mode?a("button",{staticClass:"btn reviews__submit",attrs:{type:"submit",name:"submit",value:"Сохранить"},on:{click:t.updateCurrentWork}},[t._v("Сохранить")]):t._e()])])])])};r._withStripped=!0;var i=a(11),s=a(404),o=a(41);function n(t,e,a,r,i,s,o){try{var n=t[s](o),l=n.value}catch(t){return void a(t)}n.done?e(l):Promise.resolve(l).then(r,i)}function l(t){return function(){var e=this,a=arguments;return new Promise(function(r,i){var s=t.apply(e,a);function o(t){n(s,r,i,o,l,"next",t)}function l(t){n(s,r,i,o,l,"throw",t)}o(void 0)})}}function c(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{},r=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(a).filter(function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable}))),r.forEach(function(e){u(t,e,a[e])})}return t}function u(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var v={mixins:[a(41).mixin],validators:{"reviewData.text":function(t){return o.Validator.value(t).required("Поле отзыв обязательно для заполнения")},"reviewData.occ":function(t){return o.Validator.value(t).required("Поле титул обязательно для заполнения")},"reviewData.author":function(t){return o.Validator.value(t).required("Поле имя автора обязательно для заполнения")},"reviewData.photo":function(t){return o.Validator.value(t).required("Вставьте файл")}},props:{mode:String},data:function(){return{reviewData:{photo:"",author:"",occ:"",text:""},photoURl:"",hasImage:!1,textTitle:"Добавить фото ",copyImgPath:""}},methods:c({},Object(i.b)("reviews",["addReview","updateReveiw"]),Object(i.b)("tooltips",["showTooltip"]),{loadPhoto:function(t){var e=this,a=t.target.files[0];this.hasImage=!0,this.reviewData.photo=a,this.hasImage=!0,this.textTitle="Изменить фото",console.log(a),console.log(this.reviewData.photo);var r=new FileReader;try{r.readAsDataURL(a),r.onload=function(){e.photoURl=r.result,console.log(e.photoURl)}}catch(t){alert(t.message),console.log(t.message.errors.photo)}},addNewReview:function(){var t=l(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$validate();case 2:if(t.t0=t.sent,!1!==t.t0){t.next=6;break}return this.showTooltip({type:"error",text:"Не все поля заполнены"}),t.abrupt("return");case 6:return t.prev=6,t.next=9,this.addReview(this.reviewData);case 9:this.$emit("toogleAddingForm"),this.showTooltip({type:"success",text:"Отзыв успешно добавлен"}),t.next=16;break;case 13:t.prev=13,t.t1=t.catch(6),this.showTooltip({type:"error",text:"Размер картинки больше 1,5 МБ"});case 16:case"end":return t.stop()}},t,this,[[6,13]])}));return function(){return t.apply(this,arguments)}}(),updateCurrentWork:function(){var t=l(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$validate();case 2:if(t.t0=t.sent,!1!==t.t0){t.next=6;break}return this.showTooltip({type:"error",text:"Не все поля заполнены"}),t.abrupt("return");case 6:return t.prev=6,t.next=9,this.updateReveiw(this.reviewData);case 9:this.$emit("toogleAddingForm"),this.showTooltip({type:"success",text:"Отзыв успешно обновлен"}),t.next=17;break;case 13:t.prev=13,t.t1=t.catch(6),console.log(t.t1.message),this.showTooltip({type:"error",text:"Размер картинки больше 1,5 МБ"});case 17:case"end":return t.stop()}},t,this,[[6,13]])}));return function(){return t.apply(this,arguments)}}(),toogleAddingForm:function(){this.$emit("toogleAddingForm")},addingMode:function(){this.reviewData={photo:"",author:"",occ:"",text:""},this.photoURl="",this.hasImage=!1,this.textTitle="Добавить фото"},editingMode:function(){this.photoURl="",this.reviewData=c({},this.currentReview),this.hasImage=!0,this.photoURl=Object(s.a)(this.reviewData.photo),this.textTitle="Изменить фото"}}),computed:c({},Object(i.c)("reviews",{currentReview:function(t){return t.currentReview}})),created:function(){"edit"==this.mode?(console.log("edit mode"),this.editingMode()):"add"==this.mode&&(console.log("add mode"),this.addingMode())},watch:{mode:function(){"add"==this.mode?(console.log("Режим добавления"),this.addingMode()):"edit"==this.mode&&(console.log("Режим редактирования"),this.editingMode())},currentReview:function(){this.reviewData=c({},this.currentReview),this.photoURl="",this.photoURl=Object(s.a)(this.reviewData.photo)}}},d=(a(416),a(25)),w=Object(d.a)(v,r,[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"reviews__title-wrap"},[e("h2",{staticClass:"reviews__title tittle"},[this._v("Новый отзыв")])])}],!1,null,"46b6a48f",null);w.options.__file="src/admin/components/reviews-add.vue";e.default=w.exports}}]);